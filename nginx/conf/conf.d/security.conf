# 安全配置

# 防止XSS攻击
add_header X-XSS-Protection "1; mode=block";

# 防止Clickjacking
add_header X-Frame-Options "SAMEORIGIN";

# 防止MIME类型嗅探
add_header X-Content-Type-Options "nosniff";

# 启用HSTS
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;

# 限制请求方法
if ($request_method !~ ^(GET|POST|PUT|DELETE|OPTIONS)$ ) {
    return 405;
}

# 限制请求体大小
client_max_body_size 10m;

# 限制请求速率
limit_req_zone $binary_remote_addr zone=mylimit:10m rate=10r/s;

# 限制并发连接数
limit_conn_zone $binary_remote_addr zone=perip:10m;
limit_conn_zone $server_name zone=perserver:10m;

# 禁止访问隐藏文件
location ~ /\. {
    deny all;
    access_log off;
    log_not_found off;
}

# 禁止访问敏感文件
location ~* (\.log|\.pid|\.conf)$ {
    deny all;
    access_log off;
    log_not_found off;
}